<!-- Navbar -->
<nav class="navbar navbar-dark" style="background-color: #32cd32;">
  <div class="container-fluid">
    <a class="navbar-brand" routerLink="/home">Green Count</a>
    <button class="navbar-toggler" type="button" (click)="toggleMenu()" aria-controls="offcanvasNav"
      aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasNav"
      aria-labelledby="offcanvasNavLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavLabel">Green Count Menu</h5>
        <button type="button" class="btn-close btn-close-white" (click)="toggleMenu()" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="navbar-nav flex-column">
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/home">Home</a>
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/chat">AI Chatbot</a>
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/daily-emissions">Daily Emissions</a>
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/weekly-emissions">Weekly Emissions</a>
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/information">Information</a>
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/food-emissions">Food Emissions</a>
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link text-white" routerLink="/settings">Settings</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</nav>


<div class="container mt-4">

  <!-- Page Title -->
  <h2 class="text-center mb-4">Emission Chat Assistant</h2>

  <!-- Chat Box -->
  <div class="card shadow-sm" style="max-width: 800px; margin: 0 auto;">
    <div class="card-body d-flex flex-column" style="height: 400px;">

      <!-- Scrollable area for messages -->
      <div class="flex-grow-1 overflow-auto mb-3" style="scroll-behavior: smooth;">
        <div *ngFor="let msg of messages; trackBy: trackByFn" [ngClass]="{
          'text-start': msg.sender === 'user',
          'text-end': msg.sender !== 'user'
        }">
          <!-- Example styling: user-message vs ai-message -->
          <div class="p-2 my-1 rounded-3"
            [ngClass]="msg.sender === 'user' ? 'bg-light border user-message' : 'bg-success text-white ai-message'">
            <strong>{{ msg.sender === 'user' ? 'You' : 'AI' }}:</strong> {{ msg.text }}
          </div>
        </div>
      </div>

      <!-- Chat Input + Send Button -->
      <div class="d-flex">
        <input type="text" class="form-control me-2" [(ngModel)]="userMessage" placeholder="Ask about your emissions..."
          (keyup.enter)="sendMessage()" />
        <button class="btn btn-primary" (click)="sendMessage()">Send</button>
      </div>

    </div>
  </div>

  <!-- Powered by ChatGPT Note -->
  <div class="alert alert-secondary text-center mt-3" role="alert">
    Powered by OpenAIâ€™s GPT-3.5 technology
  </div>

  <!-- Back to Home Button -->
  <div class="text-center mt-4">
    <button class="btn btn-secondary" (click)="goHome()">Back to Home</button>
  </div>

</div>