<!-- Start of GreenCount Home Component -->

<!-- Added a professional Navbar with Bootstrap -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">GreenCount</a>
    <!-- You can add a toggler and Nav items here if needed -->
  </div>
</nav>

<!-- Wrapped everything in a container for proper Bootstrap layout -->
<div class="container mt-4">

  <h1 class="mb-4 text-center">GreenCount Dashboard</h1>
  <p class="text-center">{{ message }}</p>

  <!-- Action Buttons -->
  <!-- <div>
    <button (click)="fetchData()">Fetch Data</button>
    <button (click)="summarizeData()">Summarize Metric</button>
  </div> -->

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" style="color: blue;">Loading...</div>

  <!-- Data Table -->
  <!-- <div *ngIf="data && data.length > 0">
    <h2>Data Table</h2>
    <table border="1" style="width: 100%; border-collapse: collapse; text-align: left;">
      <thead>
        <tr>
          <th>Metric</th>
          <th>Unit</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of data">
          <td>{{ item.Metric }}</td>
          <td>{{ item.Unit }}</td>
          <td>{{ item.Value }}</td>
        </tr>
      </tbody>
    </table>
  </div> -->

  <!-- Add Data Form -->
  <!-- <div>
    <h2>Add New Data</h2>
    <label>Metric:</label>
    <select [(ngModel)]="metric">
      <option value="Electricity">Electricity</option>
      <option value="Water">Water</option>
      <option value="Gas">Gas</option>
    </select>

    <label>Unit:</label>
    <select [(ngModel)]="unit">
      <option *ngIf="metric === 'Electricity'" value="kWh">kWh</option>
      <option *ngIf="metric === 'Electricity'" value="MWh">MWh</option>
      <option *ngIf="metric !== 'Electricity'" value="liters">Liters</option>
      <option *ngIf="metric !== 'Electricity'" value="gallons">Gallons</option>
      <option *ngIf="metric !== 'Electricity'" value="cubic meters">Cubic Meters</option>
    </select>

    <label>Value:</label>
    <input type="number" [(ngModel)]="value" placeholder="Enter value (e.g., 100)" />
    <button (click)="addData()">Submit</button>
  </div> -->

  <!-- Convert Data Form -->
  <!-- <div>
    <h2>Convert Data</h2>
    <label>Metric:</label>
    <select [(ngModel)]="conversionMetric">
      <option value="Electricity">Electricity</option>
      <option value="Water">Water</option>
      <option value="Gas">Gas</option>
    </select>

    <label>Value:</label>
    <input type="number" [(ngModel)]="conversionValue" placeholder="Enter value to convert" />

    <label>Target Unit:</label>
    <select [(ngModel)]="targetUnit">
      <option *ngIf="conversionMetric === 'Electricity'" value="kWh">kWh</option>
      <option *ngIf="conversionMetric === 'Electricity'" value="MWh">MWh</option>
      <option *ngIf="conversionMetric !== 'Electricity'" value="liters">Liters</option>
      <option *ngIf="conversionMetric !== 'Electricity'" value="gallons">Gallons</option>
      <option *ngIf="conversionMetric === 'Gas'" value="cubic meters">Cubic Meters</option>
      <option *ngIf="conversionMetric === 'Gas'" value="liters">Liters</option>
    </select>

    <button (click)="convertData()">Convert</button>
  </div> -->

  <!-- Conversion Result -->
  <!-- <div *ngIf="convertedData">
    <h3>Conversion Result</h3>
    <p><strong>Metric:</strong> {{ convertedData.Metric }}</p>
    <p><strong>Original Value:</strong> {{ convertedData.OriginalValue }}</p>
    <p><strong>Converted Value:</strong> {{ convertedData.ConvertedValue }}</p>
    <p><strong>Target Unit:</strong> {{ convertedData.TargetUnit }}</p>
  </div> -->

  <!-- Card for Energy Emissions -->
  <div class="card mb-4">
    <div class="card-header">
      <h3>Energy Impact</h3>
    </div>
    <div class="card-body" *ngIf="energyEmissions !== null">
      <p><strong>CO2 Emissions:</strong> {{ energyEmissions }} tons of CO2</p>
    </div>
  </div>

  <!-- Card for Food Impact Form -->
  <div class="card mb-4">
    <div class="card-header">
      <h3>Calculate Food Impact</h3>
    </div>
    <div class="card-body">
      <!-- Using .row and .col for layout -->
      <div class="row g-3 align-items-center">
        <div class="col-md-6">
          <label class="form-label">Food Item:</label>
          <select class="form-select" [(ngModel)]="foodItem">
            <option value="beef">Beef</option>
            <option value="chicken">Chicken</option>
            <option value="pork">Pork</option>
            <option value="vegetables">Vegetables</option>
            <option value="dairy">Dairy</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">Weight (kg):</label>
          <input type="number" class="form-control" [(ngModel)]="foodWeight" placeholder="Enter weight in kg" />
        </div>
      </div>
      <button class="btn btn-success mt-3" (click)="convertFoodImpact()">Calculate Food Impact</button>
    </div>
  </div>

  <!-- Food Impact Result -->
  <div *ngIf="foodEmissions !== null" class="alert alert-info">
    <h3>Food Impact Result</h3>
    <p><strong>Food Item:</strong> {{ foodItem }}</p>
    <p><strong>Weight:</strong> {{ foodWeight }} kg</p>
    <p><strong>CO2 Emissions:</strong> {{ foodEmissions }} kg</p>
  </div>

  <!-- Buttons (styled with Bootstrap classes) -->
  <button class="btn btn-info mt-3" (click)="goToChat()">Go to AI Chatbot for Emissions related advice</button>
  <br><br>
  <button class="btn btn-warning" (click)="goToDailyEmissions()">Calculate Daily Emissions</button>
  <button class="btn btn-primary mt-3" (click)="loadUserEmissions()">Load My Emissions</button>

  <!-- Conditionally displayed table of userEmissions -->
  @if (userEmissions.length > 0) 
  {
    <table class="table table-bordered mt-3">
      <thead>
        <tr>
          <th>Metric</th>
          <th>Unit</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        @for (emission of userEmissions; track emission) {
          <tr>
            <td>{{ emission.metric }}</td>
            <td>{{ emission.unit }}</td>
            <td>{{ emission.value }}</td>
          </tr>
        }
      </tbody>
    </table>
  } @else {
    <p>No emissions data found.</p>
  }

  <!-- Add Emission Form -->
  <!-- Add Emission Form -->
  <div class="card mt-4">
    <div class="card-header">
      <h3>Add Emission</h3>
    </div>
    <div class="card-body">
      <!-- We use row/col for a more structured form layout -->
      <div class="row g-3 mb-3">
        <div class="col-md-4">
          <label class="form-label">Category:</label>
          <select class="form-select" [(ngModel)]="newEmission.category">
            <option value="Car">Car</option>
            <option value="Transport">Transport</option>
            <option value="Energy">Energy</option>
            <option value="Working">Working</option>
            <option value="Accommodation">Accommodation</option>
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label">Type:</label>
          <select class="form-select" [(ngModel)]="newEmission.type">
            <!-- Car options -->
            @if (newEmission.category === 'Car') {
              <option value="Diesel">Diesel</option>
              <option value="Petrol">Petrol</option>
              <option value="Hybrid">Hybrid</option>
            }
            <!-- Transport options -->
            @if (newEmission.category === 'Transport') {
              <option value="Taxi">Taxi</option>
              <option value="Bus">Bus</option>
              <option value="Rail">Rail</option>
              <option value="Flight">Flight</option>
            }
            <!-- Energy options -->
            @if (newEmission.category === 'Energy') {
              <option value="Electricity">Electricity</option>
            }
            <!-- Working options -->
            @if (newEmission.category === 'Working') {
              <option value="Office">Office</option>
              <option value="Home">Home</option>
            }
            <!-- Accommodation options -->
            @if (newEmission.category === 'Accommodation') {
              <option value="Hotel-UK">Hotel-UK</option>
              <option value="Hotel-London">Hotel-London</option>
            }
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label">Value:</label>
          <input type="number" class="form-control" [(ngModel)]="newEmission.value" placeholder="Enter Value" />
        </div>
      </div>
      <button class="btn btn-primary" (click)="addEmission()">Add Emission</button>
    </div>
  </div>

  <app-emission-chart></app-emission-chart>

  <!-- Show Emissions Table -->
  @if (userEmissions.length > 0) {
    <table class="table table-striped table-bordered mt-3">
      <thead>
        <tr>
          <th>Category</th>
          <th>Type</th>
          <th>Value</th>
          <th>Unit</th>
          <th>Emissions</th>
        </tr>
      </thead>
      <tbody>
        @for (emission of userEmissions; track emission) {
          <tr>
            <td>{{ emission.category }}</td>
            <td>{{ emission.type }}</td>
            <td>{{ emission.value }}</td>
            <td>{{ emission.unit }}</td>
            <td>{{ emission.emissions }} kg CO2</td>
          </tr>
        }
      </tbody>
    </table>
  } @else {
    <p>No emissions data found.</p>
  }

  <button class="btn btn-danger mt-3" (click)="logout()">Sign Out</button>
</div>
<!-- End of GreenCount Home Component -->

<!-- A simple footer for a more professional look -->
<footer class="bg-light text-center py-3 mt-5">
  <div class="container">
    <small class="text-muted">Â© 2025 GreenCount. All Rights Reserved.</small>
  </div>
</footer>
